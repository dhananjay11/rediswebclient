<h2 class="text-center">Key Browser</h2>
<div ng-controller="RedisCtrl as redis">
    <div ng-controller="AddNewKVCtrl as addnewform">
        <p>
            <a class="btn btn-default buttonbuffer" ng-click="redis.refreshAllKeys()">Refresh</a>
            <a href class="btn btn-default buttonbuffer" ng-click="addnewform.toggleForm()">Toggle Add New Form</a>
            <input class="search" ng-model="searchText" placeholder="search keys" ng-change="redis.filterForKeys(searchText)"/>
        </p>
        <div ng-show="addnewform.show">
            <form class="redis-form" novalidate name="newkvform"  ng-submit="redis.setNewKeyVal(newKeyValModel)">
                <!--  Preview -->
                <h4>Entry to be added:</h4>
                <blockquote>
                    <strong>Key: {{newKeyValModel.key}}</strong><br>
                    <cite class="clearfix">Value: {{newKeyValModel.value}}</cite>
                </blockquote>
                <!--  add new key/value Form -->
                <fieldset class="form-group">
                    <input ng-model="newKeyValModel.key" name="newkey" class="form-control" title="new key" placeholder="key" required></input>
                </fieldset>
                <fieldset class="form-group">
                    <textarea ng-model="newKeyValModel.value" name="newval" class="form-control" placeholder="value" title="value" required></textarea>
                </fieldset>
                <fieldset class="form-group">
                    <input ng-show="newkvform.newkey.$dirty && newkvform.newval.$dirty" type="submit" class="btn btn-primary pull-right" value="Set Key" />
                </fieldset>
            </form>
        </div>
    </div>
    <table class="racetimes">
        <tr id="firstrow">
            <th>Key</th>
            <th>Value</th>
            <th>Controls</th>
        </tr>
        <tr ng-repeat="key in keysList | orderBy: key" ng-show="!showSearchResults || (showSearchResults && searchResults[key])">
            <td data-th="Key">
                <a href ng-click="redis.getKeyVal(key)">{{ key }}</a>
            </td>
            <td data-th="Value">
                <form role="form" class="redis-form" novalidate name="modifyForm" ng-submit="redis.updateExistingKey(key, redis.updateExistingKey[key])">
                    <input ng-model="redis.updateExistingKey[key]" ng-show="showKVFormFor[key]" placeholder="{{ cachedKeyVals[key] }}" name="newval" required>
                    <kval ng-show="!showKVFormFor[key]">{{ cachedKeyVals[key] }}</kval>
                </form>
            </td>
            <td data-th="Controls">
                <kval ng-click="redis.editValueIconClick(key)">
                <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                </kval>
            </td>
        </tr>
    </table>
</div>